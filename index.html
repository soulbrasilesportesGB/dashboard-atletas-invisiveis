
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard — Atletas Invisíveis (60 dias)</title>
  <style>
    :root {
      --bg: #0b0c0e; 
      --card: #14161a;
      --text: #f4f4f5;
      --muted: #a1a1aa;
      --accent: #00a39b;
      --red: #dc2626;
      --yellow: #f59e0b;
      --green: #16a34a;
      --chip: #1f2228;
      --border: #1f2329;
    }
    body {
      margin: 0; padding: 32px; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: radial-gradient(1200px 600px at 10% -10%, rgba(0,163,155,0.15), transparent 60%),
                  radial-gradient(800px 400px at 100% 0%, rgba(245,158,11,0.12), transparent 60%),
                  var(--bg);
      color: var(--text);
    }
    .container { max-width: 1200px; margin: 0 auto; }
    h1 { font-size: 28px; margin: 0 0 8px 0; letter-spacing: 0.5px; }
    p.subtitle { color: var(--muted); margin-top: 0; }
    .grid { display: grid; gap: 16px; }
    .grid.cards { grid-template-columns: repeat(4, minmax(0, 1fr)); }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.00));
      border: 1px solid var(--border);
      border-radius: 16px; padding: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.25);
      backdrop-filter: blur(6px);
    }
    .stat-title { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.1em; }
    .stat-value { font-size: 28px; font-weight: 700; margin-top: 6px; }
    .controls { display: flex; gap: 12px; flex-wrap: wrap; margin: 16px 0; }
    .input, .select {
      background: var(--card); color: var(--text); border: 1px solid var(--border);
      padding: 10px 12px; border-radius: 12px; outline: none; min-width: 180px;
    }
    table {
      width: 100%; border-collapse: collapse; overflow: hidden;
      border: 1px solid var(--border); border-radius: 14px; background: var(--card);
    }
    thead th { text-align: left; font-size: 12px; color: var(--muted); padding: 12px; border-bottom: 1px solid var(--border); }
    tbody td { padding: 12px; border-top: 1px solid var(--border); font-size: 14px; }
    tr:hover td { background: #181b21; }
    .status { display: inline-flex; align-items: center; gap: 8px; padding: 6px 10px; border-radius: 999px; font-size: 12px; font-weight: 600; }
    .status.risco { background: rgba(220,38,38,0.15); color: #fecaca; border: 1px solid rgba(220,38,38,0.6); }
    .status.atencao { background: rgba(245,158,11,0.15); color: #fde68a; border: 1px solid rgba(245,158,11,0.6); }
    .status.estavel { background: rgba(22,163,74,0.15); color: #bbf7d0; border: 1px solid rgba(22,163,74,0.6); }
    .badge { background: var(--chip); color: var(--muted); font-size: 12px; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); }
    .section-title { font-size: 18px; margin: 20px 0 8px; }
    .muted { color: var(--muted); }
    .link { color: var(--accent); text-decoration: none; }
    .footer { margin-top: 32px; color: var(--muted); font-size: 12px; }
    .split { display: grid; grid-template-columns: 2fr 1fr; gap: 16px; }
    @media (max-width: 900px) { .grid.cards { grid-template-columns: repeat(2, minmax(0, 1fr)); } .split { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>Dashboard – Atletas Invisíveis (últimos 60 dias)</h1>
    <p class="subtitle">Resumo por atleta (insights) + drill-down por sessão.</p>

    <div class="grid cards" id="kpis">
      <div class="card"><div class="stat-title">Atletas</div><div class="stat-value" id="kpi-atletas">–</div></div>
      <div class="card"><div class="stat-title">Sessões</div><div class="stat-value" id="kpi-sessoes">–</div></div>
      <div class="card"><div class="stat-title">Nota média</div><div class="stat-value" id="kpi-nota">–</div></div>
      <div class="card"><div class="stat-title">Δ humor (depois - antes)</div><div class="stat-value" id="kpi-delta">–</div></div>
    </div>

    <div class="controls">
      <select class="select" id="filtro-status">
        <option value="">Status (todos)</option>
        <option value="Risco">Risco</option>
        <option value="Atenção">Atenção</option>
        <option value="Estável">Estável</option>
      </select>
      <input class="input" id="busca-atleta" placeholder="Buscar atleta..." />
      <button class="input" id="limpar">Limpar filtros</button>
    </div>

    <div class="card">
      <div class="section-title">Insights por atleta</div>
      <table>
        <thead>
          <tr>
            <th>Atleta</th>
            <th>Modalidade</th>
            <th class="muted">Sessões</th>
            <th>Nota média</th>
            <th>Humor antes</th>
            <th>Humor depois</th>
            <th>Δ Humor</th>
            <th>Frequência/semana</th>
            <th>Aptidão (média)</th>
            <th>Match Mod.</th>
            <th>Status</th>
            <th>Flags</th>
          </tr>
        </thead>
        <tbody id="tabela-insights"></tbody>
      </table>
    </div>

    <div class="split">
      <div class="card">
        <div class="section-title">Sessões do atleta selecionado</div>
        <div class="muted" id="selecionado-info">Selecione um atleta na tabela para ver os treinos.</div>
        <table>
          <thead>
            <tr>
              <th>Data</th><th>Modalidade</th><th>Intensidade</th><th>Duração</th><th>Nota</th><th>Antes</th><th>Depois</th>
            </tr>
          </thead>
          <tbody id="tabela-sessoes"></tbody>
        </table>
      </div>
      <div class="card">
        <div class="section-title">Sugestões (auto)</div>
        <div id="sugestoes" class="muted">—</div>
      </div>
    </div>

    <div class="footer">
      Fonte: CSVs gerados via análise (insights_60d / base_60d). Você pode abrir este HTML e compartilhar diretamente.
    </div>
  </div>

  <script>
    const INSIGHTS = [{"Atleta": "Allana Gonçalves", "modalidade_treino": "Escalada", "sessoes": 1, "media_nota": 5.0, "media_sent_antes": 5.0, "media_sent_depois": 4.0, "delta_sent": -1.0, "freq_semana": 0.12, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Ana Carvalho", "modalidade_treino": "Escalada", "sessoes": 1, "media_nota": 5.0, "media_sent_antes": 5.0, "media_sent_depois": 4.0, "delta_sent": -1.0, "freq_semana": 0.12, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Beatriz Lima", "modalidade_treino": "Vôlei", "sessoes": 4, "media_nota": 4.25, "media_sent_antes": 4.5, "media_sent_depois": 5.0, "delta_sent": 0.5, "freq_semana": 0.47, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Brayan Reis", "modalidade_treino": "Basquete", "sessoes": 1, "media_nota": 4.0, "media_sent_antes": 3.0, "media_sent_depois": 5.0, "delta_sent": 2.0, "freq_semana": 0.12, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Diego Rossi", "modalidade_treino": "Futsal", "sessoes": 2, "media_nota": 5.0, "media_sent_antes": 5.0, "media_sent_depois": 5.0, "delta_sent": 0.0, "freq_semana": 0.23, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Felipe Silva", "modalidade_treino": "Futsal", "sessoes": 1, "media_nota": 4.0, "media_sent_antes": 5.0, "media_sent_depois": 5.0, "delta_sent": 0.0, "freq_semana": 0.12, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Gabriel Neves", "modalidade_treino": "Basquete", "sessoes": 3, "media_nota": 5.0, "media_sent_antes": 3.67, "media_sent_depois": 5.0, "delta_sent": 1.33, "freq_semana": 0.35, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Kaique Oliveira", "modalidade_treino": "Basquete", "sessoes": 4, "media_nota": 5.0, "media_sent_antes": 2.0, "media_sent_depois": 5.0, "delta_sent": 3.0, "freq_semana": 0.47, "status": "Risco", "flags": "humor consistentemente baixo, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Kauan Brito", "modalidade_treino": "Basquete", "sessoes": 6, "media_nota": 3.33, "media_sent_antes": 3.0, "media_sent_depois": 3.5, "delta_sent": 0.5, "freq_semana": 0.7, "status": "Estável", "flags": null, "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Kauan Maia", "modalidade_treino": "Futsal", "sessoes": 5, "media_nota": 3.6, "media_sent_antes": 4.0, "media_sent_depois": 4.2, "delta_sent": 0.2, "freq_semana": 0.58, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Miguel Sirtoli", "modalidade_treino": "BMX", "sessoes": 1, "media_nota": 4.0, "media_sent_antes": 3.0, "media_sent_depois": 5.0, "delta_sent": 2.0, "freq_semana": 0.12, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Nick Ribeiro", "modalidade_treino": "Escalada", "sessoes": 2, "media_nota": 5.0, "media_sent_antes": 4.0, "media_sent_depois": 1.0, "delta_sent": -3.0, "freq_semana": 0.23, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Pablo Bonfim", "modalidade_treino": "BMX", "sessoes": 5, "media_nota": 4.6, "media_sent_antes": 4.2, "media_sent_depois": 2.2, "delta_sent": -2.0, "freq_semana": 0.58, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Pietro Oliveira", "modalidade_treino": "BMX", "sessoes": 1, "media_nota": 4.0, "media_sent_antes": 5.0, "media_sent_depois": 5.0, "delta_sent": 0.0, "freq_semana": 0.12, "status": "Risco", "flags": "sem melhora de humor após treino, baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Pietro Soares", "modalidade_treino": "Basquete", "sessoes": 5, "media_nota": 4.0, "media_sent_antes": 3.4, "media_sent_depois": 4.0, "delta_sent": 0.6, "freq_semana": 0.58, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Sarah Silva", "modalidade_treino": "Vôlei", "sessoes": 10, "media_nota": 3.1, "media_sent_antes": 2.5, "media_sent_depois": 3.6, "delta_sent": 1.1, "freq_semana": 1.17, "status": "Risco", "flags": "humor consistentemente baixo, nota média baixa do treino", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Stephany Souza", "modalidade_treino": "Escalada", "sessoes": 3, "media_nota": 4.33, "media_sent_antes": 3.0, "media_sent_depois": 4.0, "delta_sent": 1.0, "freq_semana": 0.35, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Vitor Henrique", "modalidade_treino": "Basquete", "sessoes": 3, "media_nota": 5.0, "media_sent_antes": 4.33, "media_sent_depois": 5.0, "delta_sent": 0.67, "freq_semana": 0.35, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Vitor Messias", "modalidade_treino": "Vôlei", "sessoes": 6, "media_nota": 5.0, "media_sent_antes": 3.86, "media_sent_depois": 4.71, "delta_sent": 0.86, "freq_semana": 0.7, "status": "Estável", "flags": null, "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}, {"Atleta": "Yasmin Zikert", "modalidade_treino": "Vôlei", "sessoes": 2, "media_nota": 5.0, "media_sent_antes": 4.0, "media_sent_depois": 5.0, "delta_sent": 1.0, "freq_semana": 0.23, "status": "Atenção", "flags": "baixa assiduidade", "apt_top_media": null, "modalidade_apt_top": null, "match_modalidade": "Não"}];
    const BASE = [{"usuario": "allana.gonçalves@atletasinvisiveis.com", "data_treino": "2025-05-08", "modalidade": "Escalada", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 4}, {"usuario": "ana.carvalho@atletasinvisiveis.com", "data_treino": "2025-04-29", "modalidade": "Escalada", "duracao": "30 min", "intensidade": "Normal", "mente": "Tranquilo", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 4}, {"usuario": "beatriz.lima@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Concentrado", "lesao": null, "nota": 3, "sent_antes": 5, "sent_depois": 5}, {"usuario": "beatriz.lima@atletasinvisiveis.com", "data_treino": "2025-05-27", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "beatriz.lima@atletasinvisiveis.com", "data_treino": "2025-05-30", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 5, "sent_depois": 5}, {"usuario": "beatriz.lima@atletasinvisiveis.com", "data_treino": "2025-06-03", "modalidade": "Vôlei", "duracao": "60 -90 min", "intensidade": "Difícil", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "brayan.reis@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 5}, {"usuario": "diego.rossi@atletasinvisiveis.com", "data_treino": "2025-05-05", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "diego.rossi@atletasinvisiveis.com", "data_treino": "2025-05-08", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "felipe.silva@atletasinvisiveis.com", "data_treino": "2025-05-29", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 5, "sent_depois": 5}, {"usuario": "gabriel.neves@atletasinvisiveis.com", "data_treino": "2025-04-29", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "gabriel.neves@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "gabriel.neves@atletasinvisiveis.com", "data_treino": "2025-06-24", "modalidade": "Basquete", "duracao": "90 - 120 min", "intensidade": "Fácil ", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "kaique.oliveira@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Tranquilo", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "kaique.oliveira@atletasinvisiveis.com", "data_treino": "2025-05-09", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "kaique.oliveira@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 1, "sent_depois": 5}, {"usuario": "kaique.oliveira@atletasinvisiveis.com", "data_treino": "2025-06-03", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 1, "sent_depois": 5}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-04-29", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 3}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 4}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-05-09", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Feliz", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 4}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-05-23", "modalidade": "Basquete", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 3}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-05-27", "modalidade": "Basquete", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 3}, {"usuario": "kauan.brito@atletasinvisiveis.com", "data_treino": "2025-06-17", "modalidade": "Basquete", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Tranquilo", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 4}, {"usuario": "kauan.maia@atletasinvisiveis.com", "data_treino": "2025-04-28", "modalidade": "Mentoria Pat", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 1, "sent_antes": 4, "sent_depois": 4}, {"usuario": "kauan.maia@atletasinvisiveis.com", "data_treino": "2025-05-05", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 4}, {"usuario": "kauan.maia@atletasinvisiveis.com", "data_treino": "2025-05-26", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Tranquilo", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 4}, {"usuario": "kauan.maia@atletasinvisiveis.com", "data_treino": "2025-05-29", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Concentrado", "lesao": null, "nota": 3, "sent_antes": 5, "sent_depois": 5}, {"usuario": "kauan.maia@atletasinvisiveis.com", "data_treino": "2025-06-23", "modalidade": "Futsal", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 4}, {"usuario": "miguel.sirtoli@atletasinvisiveis.com", "data_treino": "2025-05-26", "modalidade": "BMX", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 5}, {"usuario": "nick.ribeiro@atletasinvisiveis.com", "data_treino": "2025-05-28", "modalidade": "Escalada", "duracao": "90 - 120 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 1}, {"usuario": "nick.ribeiro@atletasinvisiveis.com", "data_treino": "2025-06-11", "modalidade": "Escalada", "duracao": "90 - 120 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 1}, {"usuario": "pablo.bonfim@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "BMX", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "pablo.bonfim@atletasinvisiveis.com", "data_treino": "2025-05-09", "modalidade": "BMX", "duracao": "60 -90 min", "intensidade": "Exaustivo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 1}, {"usuario": "pablo.bonfim@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "BMX", "duracao": "60 -90 min", "intensidade": "Difícil", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 3}, {"usuario": "pablo.bonfim@atletasinvisiveis.com", "data_treino": "2025-05-23", "modalidade": "BMX", "duracao": "30 min", "intensidade": "Exaustivo", "mente": "Triste", "lesao": null, "nota": 3, "sent_antes": 4, "sent_depois": 1}, {"usuario": "pablo.bonfim@atletasinvisiveis.com", "data_treino": "2025-05-27", "modalidade": "BMX", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 1}, {"usuario": "pietro.oliveira@atletasinvisiveis.com", "data_treino": "2025-06-17", "modalidade": "BMX", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Tranquilo", "lesao": null, "nota": 4, "sent_antes": 5, "sent_depois": 5}, {"usuario": "pietro.soares@atletasinvisiveis.com", "data_treino": "2025-04-29", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 3}, {"usuario": "pietro.soares@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 4, "sent_depois": 4}, {"usuario": "pietro.soares@atletasinvisiveis.com", "data_treino": "2025-06-03", "modalidade": "Basquete", "duracao": "90 - 120 min", "intensidade": "Regenerativo", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "pietro.soares@atletasinvisiveis.com", "data_treino": "2025-06-13", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Tranquilo", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 3}, {"usuario": "pietro.soares@atletasinvisiveis.com", "data_treino": "2025-06-17", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 4, "sent_antes": 4, "sent_depois": 5}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-04-29", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Regenerativo", "mente": "Feliz", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Triste", "lesao": null, "nota": 3, "sent_antes": 1, "sent_depois": 3}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-09", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Feliz", "lesao": null, "nota": 4, "sent_antes": 2, "sent_depois": 5}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 3, "sent_antes": 3, "sent_depois": 4}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-23", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Triste", "lesao": null, "nota": 2, "sent_antes": 2, "sent_depois": 3}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-27", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Triste", "lesao": null, "nota": 2, "sent_antes": 2, "sent_depois": 2}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-05-30", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 5}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-06-03", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Ansioso", "lesao": null, "nota": 3, "sent_antes": 2, "sent_depois": 4}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-06-13", "modalidade": "Vôlei", "duracao": "30 min", "intensidade": "Fácil ", "mente": "Triste", "lesao": null, "nota": 2, "sent_antes": 3, "sent_depois": 3}, {"usuario": "sarah.silva@atletasinvisiveis.com", "data_treino": "2025-06-17", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Exaustivo", "mente": "Triste", "lesao": null, "nota": 2, "sent_antes": 3, "sent_depois": 2}, {"usuario": "stephany.souza@atletasinvisiveis.com", "data_treino": "2025-05-21", "modalidade": "Escalada", "duracao": "90 - 120 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 4, "sent_antes": 3, "sent_depois": 4}, {"usuario": "stephany.souza@atletasinvisiveis.com", "data_treino": "2025-05-28", "modalidade": "Escalada", "duracao": "90 - 120 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 4}, {"usuario": "stephany.souza@atletasinvisiveis.com", "data_treino": "2025-06-25", "modalidade": "Escalada", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Tranquilo", "lesao": null, "nota": 4, "sent_antes": 2, "sent_depois": 4}, {"usuario": "vitor.henrique@atletasinvisiveis.com", "data_treino": "2025-05-09", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Ansioso", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "vitor.henrique@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "vitor.henrique@atletasinvisiveis.com", "data_treino": "2025-06-13", "modalidade": "Basquete", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Tranquilo", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-04-28", "modalidade": "Mentoria Pat", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Ansioso", "lesao": null, "nota": 5, "sent_antes": 2, "sent_depois": 3}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-04-28", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Ansioso", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-05-05", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-05-08", "modalidade": "Vôlei", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 4, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-06-02", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Ansioso", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-06-12", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Difícil", "mente": "Ansioso", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "vitor.messias@atletasinvisiveis.com", "data_treino": "2025-06-16", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Fácil ", "mente": "Motivado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "yasmin.zikert@atletasinvisiveis.com", "data_treino": "2025-05-06", "modalidade": "Vôlei", "duracao": "30 - 60 min", "intensidade": "Normal", "mente": "Concentrado", "lesao": null, "nota": 5, "sent_antes": 5, "sent_depois": 5}, {"usuario": "yasmin.zikert@atletasinvisiveis.com", "data_treino": "2025-05-20", "modalidade": "Vôlei", "duracao": "60 -90 min", "intensidade": "Normal", "mente": "Feliz", "lesao": null, "nota": 5, "sent_antes": 3, "sent_depois": 5}];

    // Utilities
    const fmt = (n, d=2) => (n==null || isNaN(n) ? "—" : Number(n).toFixed(d));
    const statusClass = (s) => (s||"").toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,"").replace("ç","c").replace("ã","a").replace("õ","o");

    // KPIs
    function renderKPIs(rows) {
      const atletas = new Set(rows.map(r => r.Atleta)).size;
      const sessoes = rows.reduce((acc, r) => acc + (Number(r.sessoes)||0), 0);
      const nota = rows.length ? rows.reduce((a,r)=>a+(Number(r.media_nota)||0),0)/rows.length : null;
      const delta = rows.length ? rows.reduce((a,r)=>a+(Number(r.delta_sent)||0),0)/rows.length : null;
      document.getElementById('kpi-atletas').textContent = atletas;
      document.getElementById('kpi-sessoes').textContent = sessoes;
      document.getElementById('kpi-nota').textContent = fmt(nota);
      document.getElementById('kpi-delta').textContent = fmt(delta);
    }

    // Table
    let selectedAtleta = null;

    function renderTable(rows) {
      const tbody = document.getElementById('tabela-insights');
      tbody.innerHTML = "";

      rows.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><a href="#" class="link sel-atleta" data-atleta="${r.Atleta}">${r.Atleta}</a></td>
          <td>${r.modalidade_treino || "—"}</td>
          <td class="muted">${r.sessoes ?? "—"}</td>
          <td>${fmt(r.media_nota)}</td>
          <td>${fmt(r.media_sent_antes)}</td>
          <td>${fmt(r.media_sent_depois)}</td>
          <td>${fmt(r.delta_sent)}</td>
          <td>${fmt(r.freq_semana)}</td>
          <td>${fmt(r.apt_top_media)}</td>
          <td>${r.match_modalidade || "—"}</td>
          <td><span class="status ${statusClass(r.status)}">${r.status}</span></td>
          <td class="muted">${r.flags || "—"}</td>
        `;
        tbody.appendChild(tr);
      });

      // Click handlers
      document.querySelectorAll('.sel-atleta').forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          selectedAtleta = e.target.dataset.atleta;
          renderSessions(selectedAtleta);
          renderSuggestions(selectedAtleta, rows.find(x => x.Atleta === selectedAtleta));
        });
      });
    }

    function emailFromAtleta(nome) {
      const local = nome.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase().replace(/ /g,'.');
      return local + "@atletasinvisiveis.com";
    }

    function renderSessions(atletaNome) {
      const email = emailFromAtleta(atletaNome);
      const rows = BASE.filter(r => (r.usuario||"").toLowerCase() === email.toLowerCase());
      const info = document.getElementById('selecionado-info');
      info.textContent = rows.length ? atletaNome : atletaNome + " — sem sessões listadas neste período.";

      const tbody = document.getElementById('tabela-sessoes');
      tbody.innerHTML = "";
      rows.sort((a,b) => (a.data_treino||"").localeCompare(b.data_treino||""));
      rows.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${(r.data_treino||"").slice(0,10)}</td>
          <td>${r.modalidade || "—"}</td>
          <td>${r.intensidade || "—"}</td>
          <td>${r.duracao || "—"}</td>
          <td>${fmt(r.nota)}</td>
          <td>${fmt(r.sent_antes)}</td>
          <td>${fmt(r.sent_depois)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function renderSuggestions(atletaNome, insight) {
      const box = document.getElementById('sugestoes');
      if (!insight) { box.textContent = "—"; return; }
      const flags = (insight.flags||"").toLowerCase();

      const recs = []; let apt = (insight.apt_top_media==null? null : Number(insight.apt_top_media)); let match = (insight.match_modalidade||'')==='Sim';
      if (flags.includes("humor consistentemente baixo") || (Number(insight.media_sent_antes)||5) < 3) {
        recs.push("Apoio técnico/mental: conversa 1:1 para mapear estressores externos.");
      }
      if (flags.includes("sem melhora") || (Number(insight.delta_sent)||1) <= 0) {
        recs.push("Ajuste de carga: revisar intensidade, inserir sessões regenerativas.");
      }
      if (flags.includes("baixa assiduidade") || (Number(insight.freq_semana)||0) < 0.7) {
        recs.push("Rotina mínima: garantir ≥ 1 sessão/semana nas próximas 4 semanas.");
      }
      if ((Number(insight.media_nota)||5) < 3.2) {
        recs.push("Refinar técnica com metas micro (elevar nota média do treino).");
      }

      if (apt!=null){ if (!match) { recs.unshift("Aderência com aptidão baixa: explorar fundamentos de " + (insight.modalidade_apt_top||"") + " e considerar sessões cruzadas."); } else if (apt<3.2) { recs.unshift("Aptidão geral baixa mesmo com match: reforçar fundamentos e progressões."); } else if (apt>=3.8) { recs.unshift("Aptidão forte e alinhada: definir micro-metas técnicas e competitivas."); }}
      box.innerHTML = recs.length ? ("<ul><li>" + recs.join("</li><li>") + "</li></ul>") : "Sem recomendações específicas — manter plano atual.";
    }

    // Filters
    function applyFilters() {
      const st = document.getElementById('filtro-status').value;
      const q = document.getElementById('busca-atleta').value.toLowerCase().trim();
      let rows = [...INSIGHTS];
      if (st) rows = rows.filter(r => (r.status||"") === st);
      if (q) rows = rows.filter(r => (r.Atleta||"").toLowerCase().includes(q));
      renderKPIs(rows);
      renderTable(rows);
    }

    document.getElementById('filtro-status').addEventListener('change', applyFilters);
    document.getElementById('busca-atleta').addEventListener('input', applyFilters);
    document.getElementById('limpar').addEventListener('click', () => {
      document.getElementById('filtro-status').value = "";
      document.getElementById('busca-atleta').value = "";
      selectedAtleta = null;
      document.getElementById('tabela-sessoes').innerHTML = "";
      document.getElementById('selecionado-info').textContent = "Selecione um atleta na tabela para ver os treinos.";
      document.getElementById('sugestoes').textContent = "—";
      applyFilters();
    });

    // Initial render
    applyFilters();
  </script>
</body>
</html>
