
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agosto 2025 — Frequência & Feedbacks</title>
  <style>
    body{background:#0b0f14;color:#e6eef4;font:14px/1.5 Inter,sans-serif;margin:0}
    header{padding:28px 24px 8px}
    h1{margin:0;font-size:26px}
    .sub{color:#8ba1b0;font-size:12px;margin-top:6px}
    .wrap{padding:0 24px 28px}
    .kpis{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:16px 0}
    .kpi{background:#11161d;border:1px solid #1f2a36;border-radius:14px;padding:16px}
    .kpi .label{color:#8ba1b0;font-size:12px}
    .kpi .val{font-size:22px;font-weight:700;margin-top:6px}
    .panel{background:#11161d;border:1px solid #1f2a36;border-radius:16px;padding:16px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px 8px;border-bottom:1px solid #1f2a36;text-align:left}
    thead th{position:sticky;top:0;background:#11161d;z-index:1;font-size:12px;color:#8ba1b0}
    .status{display:inline-block;padding:2px 10px;border-radius:999px;font-weight:600}
    .ok{background:#0f2f26;color:#34d399}
    .att{background:#2a1f0f;color:#fbbf24}
    .risk{background:#2b1313;color:#f87171}
    .chip{display:inline-block;padding:2px 8px;border-radius:999px;background:#223040;border:1px solid #1f2a36;margin:2px}
    .row{display:flex;gap:12px;flex-wrap:wrap;margin:18px 0}
    select,input,button{background:#0c121a;color:#e6eef4;border:1px solid #1f2a36;border-radius:10px;padding:8px}
  </style>
</head>
<body>
  <header>
    <h1>Agosto 2025 — Frequência & Feedbacks</h1>
    <div class="sub">Consolidado mensal a partir de “Análise de Frequência” + “Respostas Typebot”.</div>
  </header>
  <div class="wrap">
    <div class="kpis">
      <div class="kpi"><div class="label">Atletas</div><div class="val" id="kpiAtletas">—</div></div>
      <div class="kpi"><div class="label">Aulas</div><div class="val" id="kpiAulas">—</div></div>
      <div class="kpi"><div class="label">Presenças</div><div class="val" id="kpiPres">—</div></div>
      <div class="kpi"><div class="label">% médio</div><div class="val" id="kpiFreq">—</div></div>
    </div>
    <div class="row">
      <label>Status</label><select id="statusSel"><option value="">Todos</option><option>OK</option><option>Atenção</option><option>Risco</option></select>
      <label>Buscar</label><input id="q" placeholder="Nome…">
      <button onclick="apply()">Aplicar</button><button onclick="reset()">Limpar</button>
    </div>
    <div class="panel">
      <table><thead><tr><th>Atleta</th><th>Pres</th><th>Faltas</th><th>Aulas</th><th>Freq</th><th>Feedbacks</th><th>Respondeu?</th><th>Status</th><th>Por quê</th></tr></thead><tbody id="body"></tbody></table>
      <div class="sub">Regras: <span class="chip">Risco</span> freq&lt;25% ou ≥4 faltas ou (sem feedback+freq&lt;40%). <span class="chip">Atenção</span> freq&lt;60% ou sem feedback. Senão <span class="chip">OK</span>.</div>
    </div>
  </div>
<script>
let ROWS=[];
function pill(s){if(s==="OK")return'<span class="status ok">OK</span>';if(s==="Atenção")return'<span class="status att">Atenção</span>';return'<span class="status risk">Risco</span>';}
function kpis(rows){let a=rows.length,p=0,au=0,f=0,c=0;rows.forEach(r=>{p+=r.presencas;au+=r.aulas;if(r.freq_perc){f+=r.freq_perc;c++;}});document.getElementById("kpiAtletas").innerText=a;document.getElementById("kpiPres").innerText=p;document.getElementById("kpiAulas").innerText=au;document.getElementById("kpiFreq").innerText=c?(f/c).toFixed(0)+"%":"—";}
function apply(){const st=document.getElementById("statusSel").value,q=document.getElementById("q").value.toLowerCase();let rows=ROWS.filter(r=>(!st||r.status===st)&&(!q||(r.Atleta||"").toLowerCase().includes(q)));kpis(rows);const tb=document.getElementById("body");tb.innerHTML="";rows.forEach(r=>{tb.innerHTML+=`<tr><td>${r.Atleta}</td><td>${r.presencas}</td><td>${r.faltas}</td><td>${r.aulas}</td><td>${r.freq_fmt}</td><td>${r.feedbacks}</td><td>${r.respondeu_feedback}</td><td>${pill(r.status)}</td><td>${r.reasons}</td></tr>`});}
function reset(){document.getElementById("statusSel").value="";document.getElementById("q").value="";apply();}
fetch("insights_agosto.json").then(r=>r.json()).then(js=>{ROWS=js;apply();});
</script></body></html>
